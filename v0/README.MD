<h1 align="center">ğŸ“š Asset Approval System v0</h1>

<div align="center">

![JavaScript](https://img.shields.io/badge/JavaScript-ES6+-yellow)
![Fabric](https://img.shields.io/badge/Fabric-2.5-blue)
![Containers](https://img.shields.io/badge/Containers-12-orange)
![Status](https://img.shields.io/badge/Status-Learning%20%2F%20POC-blue)

**Simple implementation for learning Hyperledger Fabric concepts and building POC demos.**

</div>

---

## âœ¨ Why v0?

| Best For | Not Ideal For |
|----------|---------------|
| âœ… Learning Fabric concepts | âŒ Production deployment |
| âœ… POC demonstrations | âŒ High availability needs |
| âœ… Resource-constrained environments | âŒ Multi-peer redundancy |
| âœ… Quick prototyping | âŒ Complex state machines |
| âœ… Understanding OBAC | âŒ Rejected asset resubmission |

**ğŸ‘‰ Start here to learn, then graduate to [v1](../v1/) for production.**

---

## âš¡ Quick Start

### Prerequisites

| Software | Version | Check Command |
|----------|---------|---------------|
| Docker | 20+ | `docker --version` |
| Docker Compose | v2+ | `docker compose version` |
| Node.js | 18+ | `node --version` |
| Fabric Binaries | 2.5.x | `peer version` |
| jq | Any | `jq --version` |

> âš ï¸ **Requires Linux or WSL2** - Cannot run on native Windows

### Start in 3 Commands

```bash
# 1. Navigate to v0
cd asset-approval-system/v0

# 2. Make scripts executable
chmod +x scripts/*.sh network/scripts/*.sh

# 3. Start everything (3-5 minutes)
./scripts/start-all.sh
```

**What happens:**
```
âœ“ Network started (12 containers)
âœ“ Channel created
âœ“ Chaincode deployed
âœ“ Client setup complete
âœ“ Chaincode warmed up
SUCCESS! Network is ready
```

### Run Demo & Tests

```bash
# Interactive workflow demonstration
./scripts/demo.sh

# Security tests (18 tests)
./scripts/run-tests.sh

# Fault tolerance tests
./scripts/test-fault-tolerance.sh
```

### Stop & Cleanup

```bash
./scripts/stop-all.sh
```

---

## ğŸ—ï¸ Architecture

### Network Topology (12 Containers)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ORDERING SERVICE (Raft)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  orderer0  â”‚    â”‚  orderer1  â”‚    â”‚  orderer2  â”‚               â”‚
â”‚  â”‚   :7050    â”‚    â”‚   :8050    â”‚    â”‚   :9050    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                      Tolerates 1 failure                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  ORG1 (Asset Owner)     ORG2 (Auditor)      ORG3 (Regulator)      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Peer    :7051 â”‚     â”‚ Peer    :9051 â”‚   â”‚ Peer   :11051 â”‚      â”‚
â”‚  â”‚ CA      :7054 â”‚     â”‚ CA      :8054 â”‚   â”‚ CA      :9054 â”‚      â”‚
â”‚  â”‚ CouchDB :5984 â”‚     â”‚ CouchDB :7984 â”‚   â”‚ CouchDB :8984 â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   CHANNEL: asset-channel                      â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚  â”‚  â”‚  PUBLIC LEDGER  â”‚   â”‚ PRIVATE DATA (Org1 + Org2)     â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ assetID      â”‚   â”‚ â€¢ description                  â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ status       â”‚   â”‚ â€¢ internal notes               â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ approvals    â”‚   â”‚ â€¢ valuation amount             â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ timestamps   â”‚   â”‚ â€¢ confidential terms           â”‚    â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ State Machine

```
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   CREATE    â”‚ â† Org1 creates asset
     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
            â”‚ (starts as PENDING)
            â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Both Org2 + Org3    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   PENDING   â”‚ â”€â”€â”€â”€â”€â”€ approve â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  APPROVED   â”‚ â—€â”€â”€ FINAL
     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ Any approver rejects
            â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  REJECTED   â”‚ â—€â”€â”€ FINAL (cannot resubmit in v0)
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> âš ï¸ **Note:** In v0, rejected assets cannot be resubmitted. See [v1](../v1/) for resubmission support.

---

## ğŸ” Access Control (OBAC)

Access is enforced **in chaincode** using MSP ID verification:

| Operation | Org1 (Owner) | Org2 (Auditor) | Org3 (Regulator) |
|-----------|:------------:|:--------------:|:----------------:|
| CreateAsset | âœ… | âŒ | âŒ |
| UpdateAssetStatus | âœ… | âŒ | âŒ |
| ApproveAsset | âŒ | âœ… | âœ… |
| RejectAsset | âŒ | âœ… | âœ… |
| DeleteAsset | âœ… | âŒ | âŒ |
| QueryAsset | âœ… | âœ… | âœ… |
| QueryPrivateDetails | âœ… | âœ… | âŒ |

---

## ğŸ“ Project Structure

```
v0/
â”œâ”€â”€ ğŸ“‚ scripts/                        # Automation
â”‚   â”œâ”€â”€ start-all.sh                  # Complete startup
â”‚   â”œâ”€â”€ stop-all.sh                   # Clean shutdown
â”‚   â”œâ”€â”€ demo.sh                       # Interactive demo
â”‚   â”œâ”€â”€ run-tests.sh                  # Security tests
â”‚   â””â”€â”€ test-fault-tolerance.sh       # Raft tests
â”‚
â”œâ”€â”€ ğŸ“‚ chaincode/asset-approval/
â”‚   â”œâ”€â”€ lib/assetContract.js          # Smart contract
â”‚   â”œâ”€â”€ collections_config.json       # Private data config
â”‚   â”œâ”€â”€ index.js                      # Entry point
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ ğŸ“‚ client/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app.js                    # CLI application
â”‚   â”‚   â”œâ”€â”€ config.js                 # Configuration
â”‚   â”‚   â”œâ”€â”€ gateway.js                # Network connection
â”‚   â”‚   â”œâ”€â”€ invoke.js                 # Transaction functions
â”‚   â”‚   â”œâ”€â”€ query.js                  # Query functions
â”‚   â”‚   â”œâ”€â”€ enrollAdmin.js            # Admin enrollment
â”‚   â”‚   â””â”€â”€ registerUser.js           # User registration
â”‚   â”œâ”€â”€ wallet/                       # Identity wallets (generated)
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ ğŸ“‚ network/
â”‚   â”œâ”€â”€ configtx/configtx.yaml        # Channel configuration
â”‚   â”œâ”€â”€ docker/
â”‚   â”‚   â”œâ”€â”€ docker-compose.yaml       # 12 containers
â”‚   â”‚   â””â”€â”€ docker-compose-ca.yaml    # Certificate authorities
â”‚   â”œâ”€â”€ organizations/                 # Crypto material (generated)
â”‚   â”œâ”€â”€ peercfg/core.yaml             # Peer configuration
â”‚   â””â”€â”€ scripts/                       # Network scripts
â”‚       â”œâ”€â”€ network.sh
â”‚       â”œâ”€â”€ createChannel.sh
â”‚       â”œâ”€â”€ deployCC.sh
â”‚       â”œâ”€â”€ registerEnroll.sh
â”‚       â””â”€â”€ envVar.sh
â”‚
â””â”€â”€ ğŸ“‚ docs/
    â””â”€â”€ ARCHITECTURE.md
```

---

## ğŸ–¥ï¸ CLI Commands

```bash
cd client

# Create asset (Org1 only)
node src/app.js create ASSET001 "Manufacturing Equipment" org1 admin

# Query asset (all orgs)
node src/app.js query ASSET001 org1 admin

# Query private data (Org1/Org2 only)
node src/app.js queryPrivate ASSET001 org1 admin

# Approve asset (Org2/Org3)
node src/app.js approve ASSET001 org2 admin

# Reject asset (Org2/Org3)
node src/app.js reject ASSET001 "Missing documents" org3 admin

# View history
node src/app.js history ASSET001 org1 admin

# List all assets
node src/app.js list org1 admin

# Delete asset (Org1 only)
node src/app.js delete ASSET001 org1 admin
```

---

## ğŸ§ª Test Suites

### Security Tests (`./scripts/run-tests.sh`)

| Suite | Tests | What It Validates |
|-------|-------|-------------------|
| Access Control | 6 | Create/approve permissions |
| State Machine | 3 | Finalized asset immutability |
| Rejection Workflow | 3 | Reject and block approval |
| Query Permissions | 3 | All orgs can read public data |
| Private Data | 3 | Org3 cannot access private data |
| **Total** | **18** | Full OBAC coverage |

### Fault Tolerance Tests (`./scripts/test-fault-tolerance.sh`)

| Scenario | Expected |
|----------|----------|
| All 3 orderers up | âœ… Transactions succeed |
| 1 orderer down | âœ… Transactions succeed (2/3 quorum) |
| 2 orderers down | âŒ Transactions fail (expected) |
| Orderers restart | âœ… Network recovers |

---

## âš™ï¸ Configuration

### Environment Variables (Production)

```bash
export NODE_ENV=production
export ORG1_ADMIN_SECRET=<secure-password>
export ORG2_ADMIN_SECRET=<secure-password>
export ORG3_ADMIN_SECRET=<secure-password>
export TLS_VERIFY=true
```

### Input Validation

The CLI validates all inputs:

| Field | Rules |
|-------|-------|
| Asset ID | 1-64 chars, alphanumeric + `_-` |
| Organization | org1, org2, or org3 |
| User ID | Alphanumeric + `_-` |
| Description | Max 500 chars |
| Reason | Required, max 1000 chars |

---

## ğŸ› ï¸ Troubleshooting

| Issue | Solution |
|-------|----------|
| `/bin/bash^M: bad interpreter` | `dos2unix scripts/*.sh network/scripts/*.sh` |
| `fabric-ca-client: not found` | Add `~/bin` to PATH |
| Port already in use | `docker stop $(docker ps -aq)` |
| Permission denied | `sudo chown -R $USER:$USER .` |
| ENDORSEMENT_POLICY_FAILURE | Wait 10s and retry (cold start) |

### Clean Restart

```bash
./scripts/stop-all.sh
docker volume prune -f
./scripts/start-all.sh
```

---

## ğŸ†š v0 vs v1 Comparison

| Aspect | v0 (This) | v1 |
|--------|-----------|-----|
| Complexity | Simple | Production-grade |
| Containers | 12 | 24 |
| Peers per Org | 1 | 3 |
| Language | JavaScript | TypeScript |
| States | 3 | 6 |
| Resubmit Rejected | âŒ | âœ… |

**ğŸ‘‰ Ready for production? See [v1 README](../v1/README.md)**

---

## ğŸ“„ License

Apache-2.0

---

<div align="center">

**Perfect for Learning Hyperledger Fabric**

*JavaScript Â· Simple Architecture Â· Full OBAC Demo*

[â¬…ï¸ Back to Main README](../README.md) Â· [â¡ï¸ Upgrade to v1](../v1/README.md)

</div>
